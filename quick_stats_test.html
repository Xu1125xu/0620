<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çµ±è¨ˆåŠŸèƒ½å¿«é€Ÿæ¸¬è©¦</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        button { padding: 8px 16px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin: 20px 0; }
        .stat { background: #f8f9fa; padding: 15px; border-radius: 5px; text-align: center; }
        .stat-value { font-size: 1.5em; font-weight: bold; color: #007bff; }
    </style>
</head>
<body>
    <h1>ğŸ§ª çµ±è¨ˆåŠŸèƒ½å¿«é€Ÿæ¸¬è©¦</h1>
    
    <div class="stats">
        <div class="stat">
            <div class="stat-value" id="totalReactions">0</div>
            <div>ç¸½æ¬¡æ•¸</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="successRate">0%</div>
            <div>æˆåŠŸç‡</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="standardDeviation">--</div>
            <div>ç©©å®šæ€§</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="improvement">--</div>
            <div>è©•åƒ¹</div>
        </div>
    </div>
    
    <div>
        <button onclick="runBasicTest()">åŸºæœ¬åŠŸèƒ½æ¸¬è©¦</button>
        <button onclick="runProgressiveTest()">é€²éšæ¸¬è©¦</button>
        <button onclick="clearResults()">æ¸…é™¤çµæœ</button>
    </div>
    
    <div id="results"></div>

    <script>
        // çµ±è¨ˆæ›´æ–°å‡½æ•¸ (å¾ main.js è¤‡è£½)
        function updateStatsDisplay() {
            const reactionTimes = window.testData || [];
            
            // å³æ™‚æ›´æ–°çµ±è¨ˆå€åŸŸçš„æ•¸æ“š
            const totalReactions = reactionTimes.length;
            const successfulReactions = reactionTimes.filter(time => time <= 1000).length;
            const successRate = totalReactions > 0 ? (successfulReactions / totalReactions * 100) : 0;
            
            // è¨ˆç®—æ¨™æº–å·®
            let standardDeviation = 0;
            if (reactionTimes.length > 1) {
                const average = reactionTimes.reduce((sum, time) => sum + time, 0) / reactionTimes.length;
                const variance = reactionTimes.reduce((sum, time) => sum + Math.pow(time - average, 2), 0) / reactionTimes.length;
                standardDeviation = Math.sqrt(variance);
            }
            
            // ç”Ÿæˆæ”¹å–„å»ºè­°
            let improvement = 'éœ€è¦æ•¸æ“š';
            if (totalReactions > 0) {
                if (successRate >= 90) improvement = 'å„ªç§€';
                else if (successRate >= 80) improvement = 'è‰¯å¥½';
                else if (successRate >= 70) improvement = 'æ™®é€š';
                else improvement = 'éœ€è¦æ”¹é€²';
            }
            
            // æ›´æ–° DOM å…ƒç´ 
            document.getElementById('totalReactions').textContent = totalReactions;
            document.getElementById('successRate').textContent = totalReactions > 0 ? `${successRate.toFixed(1)}%` : '0%';
            document.getElementById('standardDeviation').textContent = standardDeviation > 0 ? `${standardDeviation.toFixed(0)} ms` : '-- ms';
            document.getElementById('improvement').textContent = improvement;
            
            return { totalReactions, successRate, standardDeviation, improvement };
        }
        
        function addResult(message, type = 'info') {
            const resultsDiv = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            resultsDiv.appendChild(div);
            resultsDiv.scrollTop = resultsDiv.scrollHeight;
        }
        
        function runBasicTest() {
            addResult('é–‹å§‹åŸºæœ¬åŠŸèƒ½æ¸¬è©¦...', 'info');
            
            // åˆå§‹åŒ–æ¸¬è©¦æ•¸æ“š
            window.testData = [];
            updateStatsDisplay();
            
            // æ¸¬è©¦ 1: ç©ºæ•¸æ“š
            let stats = updateStatsDisplay();
            if (stats.totalReactions === 0 && stats.successRate === 0) {
                addResult('âœ… æ¸¬è©¦ 1 é€šé: ç©ºæ•¸æ“šç‹€æ…‹æ­£ç¢º', 'success');
            } else {
                addResult('âŒ æ¸¬è©¦ 1 å¤±æ•—: ç©ºæ•¸æ“šç‹€æ…‹ä¸æ­£ç¢º', 'error');
            }
            
            // æ¸¬è©¦ 2: æ·»åŠ ä¸€äº›æ•¸æ“š
            window.testData = [300, 450, 200, 800, 1200, 350];
            stats = updateStatsDisplay();
            
            if (stats.totalReactions === 6) {
                addResult('âœ… æ¸¬è©¦ 2a é€šé: ç¸½æ¬¡æ•¸è¨ˆç®—æ­£ç¢º', 'success');
            } else {
                addResult(`âŒ æ¸¬è©¦ 2a å¤±æ•—: ç¸½æ¬¡æ•¸æ‡‰ç‚º 6ï¼Œå¯¦éš›ç‚º ${stats.totalReactions}`, 'error');
            }
            
            // æª¢æŸ¥æˆåŠŸç‡ (<=1000ms çš„æœ‰ 5 å€‹ï¼Œç¸½å…± 6 å€‹)
            const expectedSuccessRate = (5/6 * 100);
            if (Math.abs(stats.successRate - expectedSuccessRate) < 0.1) {
                addResult('âœ… æ¸¬è©¦ 2b é€šé: æˆåŠŸç‡è¨ˆç®—æ­£ç¢º', 'success');
            } else {
                addResult(`âŒ æ¸¬è©¦ 2b å¤±æ•—: æˆåŠŸç‡æ‡‰ç‚º ${expectedSuccessRate.toFixed(1)}%ï¼Œå¯¦éš›ç‚º ${stats.successRate.toFixed(1)}%`, 'error');
            }
            
            // æª¢æŸ¥è©•åƒ¹
            if (stats.improvement === 'è‰¯å¥½') {
                addResult('âœ… æ¸¬è©¦ 2c é€šé: è©•åƒ¹æ­£ç¢º', 'success');
            } else {
                addResult(`âŒ æ¸¬è©¦ 2c å¤±æ•—: è©•åƒ¹æ‡‰ç‚ºã€Œè‰¯å¥½ã€ï¼Œå¯¦éš›ç‚ºã€Œ${stats.improvement}ã€`, 'error');
            }
            
            addResult('åŸºæœ¬åŠŸèƒ½æ¸¬è©¦å®Œæˆ', 'info');
        }
        
        function runProgressiveTest() {
            addResult('é–‹å§‹é€²éšæ¸¬è©¦...', 'info');
            
            // æ¸¬è©¦ä¸åŒè¡¨ç¾æ°´æº–
            const testCases = [
                { data: [200, 250, 300, 220, 280], expected: 'å„ªç§€', name: 'å„ªç§€è¡¨ç¾' },
                { data: [400, 500, 600, 450, 550, 1100, 800], expected: 'è‰¯å¥½', name: 'è‰¯å¥½è¡¨ç¾' },
                { data: [600, 800, 900, 1000, 1200, 700], expected: 'æ™®é€š', name: 'æ™®é€šè¡¨ç¾' },
                { data: [1200, 1500, 1800, 1100, 1300], expected: 'éœ€è¦æ”¹é€²', name: 'éœ€è¦æ”¹é€²' }
            ];
            
            testCases.forEach((testCase, index) => {
                window.testData = testCase.data;
                const stats = updateStatsDisplay();
                
                if (stats.improvement === testCase.expected) {
                    addResult(`âœ… æ¸¬è©¦ ${index + 1} é€šé: ${testCase.name} - è©•åƒ¹æ­£ç¢º`, 'success');
                } else {
                    addResult(`âŒ æ¸¬è©¦ ${index + 1} å¤±æ•—: ${testCase.name} - æœŸæœ›ã€Œ${testCase.expected}ã€ï¼Œå¯¦éš›ã€Œ${stats.improvement}ã€`, 'error');
                }
            });
            
            addResult('é€²éšæ¸¬è©¦å®Œæˆ', 'info');
        }
        
        function clearResults() {
            document.getElementById('results').innerHTML = '';
            window.testData = [];
            updateStatsDisplay();
        }
        
        // åˆå§‹åŒ–
        window.testData = [];
        updateStatsDisplay();
    </script>
</body>
</html>
